<div class="container mt-4">
      <h2 class="mb-4">
        <i class="bi bi-search me-2"></i>Iskanje
      </h2>

      <!-- Search Type Tabs -->
      <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
          <button
            class="nav-link"
            [class.active]="searchType === 'authors'"
            (click)="switchTab('authors')">
            <i class="bi bi-search me-1"></i> Iskanje avtorjev
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            [class.active]="searchType === 'titles'"
            (click)="switchTab('titles')">
            <i class="bi bi-search me-1"></i> Iskanje naslovov
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            [class.active]="searchType === 'all-authors'"
            (click)="switchTab('all-authors')">
            <i class="bi bi-people me-1"></i> Vsi avtorji
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            [class.active]="searchType === 'all-titles'"
            (click)="switchTab('all-titles')">
            <i class="bi bi-book me-1"></i> Vsi naslovi
          </button>
        </li>
      </ul>

      <!-- Search Form Component (only show for search tabs) -->
      @if (searchType === 'authors' || searchType === 'titles') {
        <app-search-form
          #searchForm
          [searchType]="searchType"
          [isLoading]="isLoading"
          (authorSearch)="onAuthorSearch($event)"
          (titleSearch)="onTitleSearch($event)">
        </app-search-form>
      }

      <!-- Loading -->
      @if (isLoading) {
        <app-loader></app-loader>
      }

      <!-- Error -->
      @if (errorMessage) {
        <div class="alert alert-danger">
          <i class="bi bi-exclamation-triangle me-2"></i>
          {{ errorMessage }}
        </div>
      }

      <!-- No Results -->
      @if (!isLoading && hasSearched && !errorMessage) {
        @if (searchType === 'authors' && authors.length === 0) {
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Ni najdenih avtorjev.
          </div>
        }
        @if (searchType === 'titles' && titles.length === 0) {
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Ni najdenih naslovov.
          </div>
        }
      }

      <!-- Author Results -->
      @if (searchType === 'authors' && authors.length > 0) {
        <h5 class="mb-3">
          <i class="bi bi-check-circle text-success me-2"></i>
          Najdeni avtorji ({{ authors.length }})
        </h5>
        <div class="row g-3">
          @for (author of paginatedSearchAuthors; track author.authorid) {
            <div class="col-md-6 col-lg-4">
              <app-author-card
                [author]="author"
                (authorSelected)="onAuthorSelected($event)">
              </app-author-card>
            </div>
          }
        </div>

        <!-- Pagination for Search Authors -->
        <app-pagination
          [currentPage]="searchAuthorsCurrentPage"
          [totalPages]="totalSearchAuthorsPages"
          (pageChange)="changeSearchAuthorsPage($event)">
        </app-pagination>
      }

      <!-- Title Results -->
      @if (searchType === 'titles' && titles.length > 0) {
        <h5 class="mb-3">
          <i class="bi bi-check-circle text-success me-2"></i>
          Najdeni naslovi ({{ titles.length }})
        </h5>
        <div class="row g-3">
          @for (title of paginatedSearchTitles; track title.isbn) {
            <div class="col-md-6">
              <app-title-card
                [title]="title"
                (titleSelected)="onTitleSelected($event)">
              </app-title-card>
            </div>
          }
        </div>

        <!-- Pagination for Search Titles -->
        <app-pagination
          [currentPage]="searchTitlesCurrentPage"
          [totalPages]="totalSearchTitlesPages"
          (pageChange)="changeSearchTitlesPage($event)">
        </app-pagination>
      }

      <!-- All Authors Tab -->
      @if (searchType === 'all-authors') {
        @if (isLoadingAll) {
          <app-loader></app-loader>
        } @else {
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="mb-0">
              <i class="bi bi-people-fill text-primary me-2"></i>
              Vsi avtorji ({{ allAuthors.length }})
            </h5>
            <div class="btn-group" role="group">
              <button
                type="button"
                class="btn btn-sm"
                [class.btn-primary]="authorsSortBy === 'firstName'"
                [class.btn-outline-primary]="authorsSortBy !== 'firstName'"
                (click)="changeAuthorsSort('firstName')">
                <i class="bi" [ngClass]="getAuthorSortIcon('firstName')"></i>
                Ime
              </button>
              <button
                type="button"
                class="btn btn-sm"
                [class.btn-primary]="authorsSortBy === 'lastName'"
                [class.btn-outline-primary]="authorsSortBy !== 'lastName'"
                (click)="changeAuthorsSort('lastName')">
                <i class="bi" [ngClass]="getAuthorSortIcon('lastName')"></i>
                Priimek
              </button>
            </div>
          </div>
          <div class="row g-3">
            @for (author of paginatedAuthors; track author.authorid) {
              <div class="col-md-6 col-lg-4">
                <app-author-card
                  [author]="author"
                  (authorSelected)="onAuthorSelected($event)">
                </app-author-card>
              </div>
            }
          </div>

          <!-- Pagination for Authors -->
          <app-pagination
            [currentPage]="allAuthorsCurrentPage"
            [totalPages]="totalAuthorsPages"
            (pageChange)="changeAuthorsPage($event)">
          </app-pagination>
        }
      }

      <!-- All Titles Tab -->
      @if (searchType === 'all-titles') {
        @if (isLoadingAll) {
          <app-loader></app-loader>
        } @else {
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="mb-0">
              <i class="bi bi-book-fill text-primary me-2"></i>
              Vsi naslovi ({{ allTitles.length }})
            </h5>
            <div class="btn-group" role="group">
              <button
                type="button"
                class="btn btn-sm"
                [class.btn-primary]="titlesSortBy === 'title'"
                [class.btn-outline-primary]="titlesSortBy !== 'title'"
                (click)="changeTitlesSort('title')">
                <i class="bi" [ngClass]="getTitleSortIcon('title')"></i>
                Naslov
              </button>
              <button
                type="button"
                class="btn btn-sm"
                [class.btn-primary]="titlesSortBy === 'author'"
                [class.btn-outline-primary]="titlesSortBy !== 'author'"
                (click)="changeTitlesSort('author')">
                <i class="bi" [ngClass]="getTitleSortIcon('author')"></i>
                Avtor
              </button>
              <button
                type="button"
                class="btn btn-sm"
                [class.btn-primary]="titlesSortBy === 'price'"
                [class.btn-outline-primary]="titlesSortBy !== 'price'"
                (click)="changeTitlesSort('price')">
                <i class="bi" [ngClass]="getTitleSortIcon('price')"></i>
                Cena
              </button>
              <button
                type="button"
                class="btn btn-sm"
                [class.btn-primary]="titlesSortBy === 'date'"
                [class.btn-outline-primary]="titlesSortBy !== 'date'"
                (click)="changeTitlesSort('date')">
                <i class="bi" [ngClass]="getTitleSortIcon('date')"></i>
                Datum
              </button>
            </div>
          </div>
          <div class="row g-3">
            @for (title of paginatedTitles; track title.isbn) {
              <div class="col-md-6">
                <app-title-card
                  [title]="title"
                  (titleSelected)="onTitleSelected($event)">
                </app-title-card>
              </div>
            }
          </div>

          <!-- Pagination for Titles -->
          <app-pagination
            [currentPage]="allTitlesCurrentPage"
            [totalPages]="totalTitlesPages"
            (pageChange)="changeTitlesPage($event)">
          </app-pagination>
        }
      }

    </div>