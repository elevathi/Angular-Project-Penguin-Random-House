<!-- Author Search Form (TDF) -->
@if (searchType === 'authors') {
<form #authorForm="ngForm" (ngSubmit)="onAuthorSearch(authorForm)" class="mb-4">
  <div class="row g-3">
    <div class="col-md-4">
      <label for="firstName" class="form-label">Ime</label>
      <input
        type="text"
        class="form-control"
        id="firstName"
        name="firstName"
        [(ngModel)]="authorCriteria.firstName"
        placeholder="npr. Dan"
        [disabled]="isLoading"
      />
    </div>
    <div class="col-md-4">
      <label for="lastName" class="form-label">Priimek</label>
      <input
        type="text"
        class="form-control"
        id="lastName"
        name="lastName"
        [(ngModel)]="authorCriteria.lastName"
        placeholder="npr. Brown"
        required
        minlength="2"
        #lastName="ngModel"
        [disabled]="isLoading"
        [ngClass]="{ 'is-invalid': lastName.invalid && lastName.touched }"
      />
      @if (lastName.invalid && lastName.touched) {
      <div class="invalid-feedback">
        @if (lastName.errors?.['required']) { Priimek je obvezen. } @if
        (lastName.errors?.['minlength']) { Minimalno 2 znaka. }
      </div>
      }
    </div>
    <div class="col-md-4 d-flex align-items-end">
      <button
        type="submit"
        class="btn btn-primary w-100"
        [disabled]="authorForm.invalid || isLoading"
      >
        @if (isLoading) {
        <span class="spinner-border spinner-border-sm me-1"></span>
        Iščem... } @else {
        <i class="bi bi-search me-1"></i> Išči avtorje }
      </button>
    </div>
  </div>
</form>
}

<!-- Title Search Form (TDF) -->
@if (searchType === 'titles') {
<form #titleForm="ngForm" (ngSubmit)="onTitleSearch(titleForm)" class="mb-4">
  <div class="row g-3">
    <!-- Title search -->
    <div class="col-md-6">
      <label for="keyword" class="form-label">Naslov</label>
      <input
        type="text"
        class="form-control"
        id="keyword"
        name="keyword"
        [(ngModel)]="titleCriteria.keyword"
        placeholder="npr. Da Vinci Code"
        required
        minlength="2"
        #keyword="ngModel"
        [disabled]="isLoading"
        [ngClass]="{ 'is-invalid': keyword.invalid && keyword.touched }"
      />
      @if (keyword.invalid && keyword.touched) {
      <div class="invalid-feedback">
        @if (keyword.errors?.['required']) { Naslov je obvezen. } @if
        (keyword.errors?.['minlength']) { Minimalno 2 znaka. }
      </div>
      }
    </div>

    <!-- Author filter -->
    <div class="col-md-3">
      <label for="author" class="form-label">Avtor</label>
      <input
        type="text"
        class="form-control"
        id="author"
        name="author"
        [(ngModel)]="titleCriteria.author"
        placeholder="npr. Dan Brown"
        [disabled]="isLoading"
      />
    </div>

    <!-- Format filter -->
    <div class="col-md-3">
      <label for="format" class="form-label">Format</label>
      <select
        class="form-select"
        id="format"
        name="format"
        [(ngModel)]="titleCriteria.format"
        [disabled]="isLoading"
      >
        @for (opt of formatOptions; track opt.code) {
          <option [value]="opt.code">{{ opt.label }}</option>
        }
      </select>
    </div>

    <!-- Exclude non-books checkbox -->
    <div class="col-md-8">
      <div class="form-check">
        <input
          type="checkbox"
          class="form-check-input"
          id="excludeNonBooks"
          name="excludeNonBooks"
          [(ngModel)]="titleCriteria.excludeNonBooks"
          [disabled]="isLoading"
        />
        <label class="form-check-label" for="excludeNonBooks">
          Samo knjige (izključi skodelice, sestavljanke, itd.)
        </label>
      </div>
    </div>

    <!-- Search button -->
    <div class="col-md-4 d-flex align-items-end">
      <button
        type="submit"
        class="btn btn-primary w-100"
        [disabled]="titleForm.invalid || isLoading"
      >
        @if (isLoading) {
        <span class="spinner-border spinner-border-sm me-1"></span>
        Iščem... } @else {
        <i class="bi bi-search me-1"></i> Išči naslove }
      </button>
    </div>
  </div>
</form>
}
